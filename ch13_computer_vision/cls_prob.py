import torch
bb_idx = torch.tensor([[0],
        [1],
        [1]])
label = torch.tensor([[0.00, 0.10, 0.08, 0.52, 0.92],
        [1.00, 0.55, 0.20, 0.90, 0.88]])
label[bb_idx, 0]
label[bb_idx, 1:]

tensor([[0.],
        [1.],
        [1.]])

cls_prob = torch.tensor([[0.00, 0.00, 0.00, 0.00],
             [0.90, 0.80, 0.70, 0.10],
            [0.10, 0.20, 0.30, 0.90]])

import torch
cls_prob = torch.tensor([[0.00, 0.00, 0.00, 0.00],
              [0.90, 0.80, 0.70, 0.10],
             [0.10, 0.20, 0.30, 0.90]])
cls_prob[1,:]
tensor([0.9000, 0.8000, 0.7000, 0.1000])
cls_prob[:,1]
tensor([0.0000, 0.8000, 0.2000])

    lt = torch.max(boxes1[:, None, :2], boxes2[:, :2])  # [N,M,2] # N中一个和M个比较； 所以由N，M 个
    rb = torch.min(boxes1[:, None, 2:], boxes2[:, 2:])  # [N,M,2]


center_h = torch.tensor([1.1, 2.1, 3.1, 4.1])
center_w = torch.tensor([1.2, 2.2, 3.2, 4.2])

(tensor([[1.1000, 1.1000, 1.1000, 1.1000],
        [2.1000, 2.1000, 2.1000, 2.1000],
        [3.1000, 3.1000, 3.1000, 3.1000],
        [4.1000, 4.1000, 4.1000, 4.1000]]),
 tensor([[1.2000, 2.2000, 3.2000, 4.2000],
        [1.2000, 2.2000, 3.2000, 4.2000],
        [1.2000, 2.2000, 3.2000, 4.2000],
        [1.2000, 2.2000, 3.2000, 4.2000]]))
